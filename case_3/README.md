# BitHealth AI - Department Recommendation API (Case 3)

This is a minimal FastAPI service that accepts patient data (age, gender, symptoms) and recommends a specialist department using an LLM (Google Gemini) via LangChain.

## 1. Environment Setup

### A. Get Your API Key
This project requires a Google AI (Gemini) API Key.

1.  Go to [Google AI Studio](https://aistudio.google.com/).
2.  Log in and create a new API key.
3.  Copy your API key.

### B. Project Setup
1.  **Copy Files**: Place `main.py` and `requirements.txt` into your project directory.

2.  **Create a Virtual Environment** (Highly Recommended):
    ```bash
    python -m venv venv
    ```
    Activate it:
    -   On Windows: `.\venv\Scripts\activate`
    -   On macOS/Linux: `source venv/bin/activate`

3.  **Install Dependencies**:
    Make sure you are in the same directory as `requirements.txt`.
    ```bash
    pip install -r requirements.txt
    ```

4.  **Create `.env` File**:
    In the same directory as `main.py`, create a new file named `.env`. Open it then add your API key and model name:
    ```
    GOOGLE_API_KEY="AIzaSy...[YOUR_API_KEY_HERE]"
    LLM_MODEL_NAME="gemini-2.5-flash-preview-09-2025"
    ```
    The Python script will automatically load this key.

## 2. Running the Application

Use `uvicorn` to run the FastAPI server. The `--reload` flag will automatically restart the server if you make changes to `main.py`.

```bash
uvicorn main:app --reload
````

The server will run on `http://127.0.0.1:8000`.

You can view the interactive API documentation (auto-generated by FastAPI) by opening this URL in your browser:
[http://127.0.0.1:8000/docs](https://www.google.com/search?q=http://127.0.0.1:8000/docs)

## 3\. How to Use (Test Endpoint)

You can test the endpoint using the interactive Swagger UI (`/docs`) or `curl` from your terminal.

### A. Using /docs (Swagger UI)

This is the easiest method for quick testing.

1.  **Open the Docs**: Navigate to [http://127.0.0.1:8000/docs](https://www.google.com/search?q=http://127.0.0.1:8000/docs) in your browser.
2.  **Find the Endpoint**: Click on the `POST /recommend` bar to expand it.
3.  **Click "Try it out"**: In the top-right corner of the panel, click the "Try it out" button.
4.  **Fill in the Request Body**: The "Request body" will become an editable text box. Enter the patient data you want to test.
    *Example:*
    ```json
    {
      "gender": "female",
      "age": 62,
      "symptoms": [
        "pusing", 
        "mual", 
        "sulit berjalan"
      ]
    }
    ```
5.  **Execute**: Click the blue **"Execute"** button below the text box.
6.  **View the Response**: Scroll down to the "Server response" section to see the JSON output.

### B. Using the Terminal (curl)

Choose the tab corresponding to your terminal.

```powershell
curl -Uri "http://127.0.0.1:8000/recommend" -Method POST -ContentType "application/json" -Body '{"gender": "female", "age": 62, "symptoms": ["pusing", "mual", "sulit berjalan", "kehilangan keseimbangan"]}' | Select-Object -ExpandProperty Content
```

### Example Success Response

Regardless of which method you use, you will receive a JSON response from the server:

```json
{
  "recommended_department": "Neurology"
}
```